apiVersion: v1
kind: Service
metadata:
  name: backend
  namespace: forgeconfig
  labels:
    app.kubernetes.io/name: backend
    app.kubernetes.io/part-of: forgeconfig
spec:
  selector:
    app.kubernetes.io/name: backend
  ports:
    - name: http
      port: 8080
      targetPort: http
      protocol: TCP
    - name: dhcp
      port: 67
      targetPort: dhcp
      protocol: UDP
    - name: tftp
      port: 69
      targetPort: tftp
      protocol: UDP
---
# NodePort service for DHCP/TFTP â€” network devices on the LAN need to
# reach these directly. Adjust nodePort values to match your environment.
apiVersion: v1
kind: Service
metadata:
  name: backend-network
  namespace: forgeconfig
  labels:
    app.kubernetes.io/name: backend
    app.kubernetes.io/part-of: forgeconfig
  annotations:
    service.kubernetes.io/description: >-
      Exposes DHCP and TFTP to the physical network for zero-touch provisioning.
      Consider using hostNetwork or MetalLB if NodePort does not suit your topology.
spec:
  type: NodePort
  selector:
    app.kubernetes.io/name: backend
  ports:
    - name: dhcp
      port: 67
      targetPort: dhcp
      protocol: UDP
      nodePort: 30067
    - name: tftp
      port: 69
      targetPort: tftp
      protocol: UDP
      nodePort: 30069
